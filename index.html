<!-- index.htmll -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>STEPS FETP India Decision Aid</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
</head>
<body data-theme="worldbank-light">
<div class="app-shell">
    <header class="app-header card">
        <div>
            <h1>STEPS FETP India Decision Aid</h1>
            <p class="subtitle">Scenario based training, outbreak response and cost benefit planner</p>
        </div>
        <div class="header-meta">
            <div class="version">
                <span class="label">Version</span>
                <span class="value version-value">App 1.3.2 Â· Model MXL-2025-12</span>
            </div>
            <div class="theme-toggle">
                <button class="pill-toggle active" type="button" data-theme-name="worldbank-light" aria-pressed="true">
                    Light
                </button>
                <button class="pill-toggle" type="button" data-theme-name="worldbank-soft" aria-pressed="false">
                    Soft
                </button>
            </div>
        </div>
    </header>

    <nav class="tabs card" role="tablist" aria-label="STEPS tabs">
        <button class="tablink active" data-tab="aboutTab" role="tab" aria-selected="true">About</button>
        <button class="tablink" data-tab="attributesTab" role="tab" aria-selected="false">Attributes and levels</button>
        <button class="tablink" data-tab="configTab" role="tab" aria-selected="false">Configuration</button>
        <button class="tablink" data-tab="resultsTab" role="tab" aria-selected="false">Results and charts</button>
        <button class="tablink" data-tab="scenariosTab" role="tab" aria-selected="false">Scenario library</button>
        <button class="tablink" data-tab="settingsTab" role="tab" aria-selected="false">Assumptions</button>
        <button class="tablink" data-tab="copilotTab" role="tab" aria-selected="false">Copilot</button>
        <button class="tablink" data-tab="diagnosticsTab" role="tab" aria-selected="false">Diagnostics</button>
        <button class="tablink" data-tab="helpTab" role="tab" aria-selected="false">Help</button>
    </nav>

    <!-- About tab -->
    <section id="aboutTab" class="tabcontent card active">
        <h2>About this tool</h2>
        <p>
            This decision aid links preferences for FETP programmes to indicative
            costs and benefits for different training scale up scenarios in India.
        </p>
        <p>
            Use the Configuration tab to define a scenario, the Results and charts tab to see headline
            indicators, the Scenario library to compare saved scenarios and the Assumptions tab to
            adjust discounting and outbreak values.
        </p>
        <div class="about-grid">
            <div class="about-card">
                <h3>Policy question presets
                    <button class="icon-help tooltip-trigger"
                            data-tooltip-title="Policy question presets"
                            data-tooltip-body="Select a preset to load a configuration that answers a typical policy question, such as baseline roll out or ambitious scale up.">
                        i
                    </button>
                </h3>
                <label for="policy-question-select" class="field-label">Select policy focus</label>
                <select id="policy-question-select" class="input">
                    <option value="baseline">Baseline roll out</option>
                    <option value="scale_up">Ambitious scale up</option>
                    <option value="budget_cap">Budget constrained roll out</option>
                </select>
                <button type="button" id="btn-apply-policy" class="btn-primary small-btn">
                    Apply preset
                </button>
                <p class="field-help">
                    Presets update trainee numbers, cohorts and benefit assumptions for quick scenario tests.
                </p>
            </div>
            <div class="about-card">
                <h3>Headline indicators</h3>
                <div class="headline-grid">
                    <div class="headline-metric">
                        <div class="label">Programme endorsement</div>
                        <div id="summary-endorsement" class="value">0 %</div>
                        <div id="hint-endorsement" class="hint"></div>
                    </div>
                    <div class="headline-metric">
                        <div class="label">Benefit cost ratio</div>
                        <div id="summary-bcr" class="value">0.00</div>
                        <div id="hint-bcr" class="hint"></div>
                    </div>
                    <div class="headline-metric">
                        <div class="label">Net present value (INR)</div>
                        <div id="summary-npv" class="value">0</div>
                    </div>
                    <div class="headline-metric">
                        <div class="label">Total trainees over horizon</div>
                        <div id="summary-trainees" class="value">0</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Attributes and levels -->
    <section id="attributesTab" class="tabcontent card" hidden>
        <h2>Attributes and levels in the mixed logit model</h2>
        <p>
            The model combines several attributes of FETP programmes. Coefficients are normalised relative
            to a baseline of a frontline, certificate only, low mentorship, blended training with 30 day response time.
        </p>
        <div class="table-wrapper">
            <table class="table">
                <thead>
                <tr>
                    <th>Attribute</th>
                    <th>Level</th>
                    <th>Coefficient</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Tier</td>
                    <td>Intermediate</td>
                    <td data-mxl="tier.intermediate">0.220</td>
                </tr>
                <tr>
                    <td>Tier</td>
                    <td>Advanced</td>
                    <td data-mxl="tier.advanced">0.487</td>
                </tr>
                <tr>
                    <td>Career benefit</td>
                    <td>University qualification</td>
                    <td data-mxl="career.uniqual">0.017</td>
                </tr>
                <tr>
                    <td>Career benefit</td>
                    <td>Structured career path</td>
                    <td data-mxl="career.career_path">-0.122</td>
                </tr>
                <tr>
                    <td>Mentorship</td>
                    <td>Medium</td>
                    <td data-mxl="mentorship.medium">0.453</td>
                </tr>
                <tr>
                    <td>Mentorship</td>
                    <td>High</td>
                    <td data-mxl="mentorship.high">0.640</td>
                </tr>
                <tr>
                    <td>Delivery</td>
                    <td>In person</td>
                    <td data-mxl="delivery.inperson">-0.232</td>
                </tr>
                <tr>
                    <td>Delivery</td>
                    <td>Online</td>
                    <td data-mxl="delivery.online">-1.073</td>
                </tr>
                <tr>
                    <td>Response time</td>
                    <td>15 days</td>
                    <td data-mxl="response.15">0.546</td>
                </tr>
                <tr>
                    <td>Response time</td>
                    <td>7 days</td>
                    <td data-mxl="response.7">0.900</td>
                </tr>
                </tbody>
            </table>
            <p class="table-note">
                Note The table lists the main attribute level coefficients used in the mixed logit model.
                Values are relative to the baseline category for each attribute. The opt out alternative has its
                own constant so that endorsement and opt out rates can be inferred for each configuration.
            </p>
        </div>
    </section>

    <!-- Configuration -->
    <section id="configTab" class="tabcontent card" hidden>
        <h2>Configure a scenario</h2>
        <div class="config-layout">
            <div class="config-form">
                <div class="field-row">
                    <div class="field">
                        <label for="input-scenario-name" class="field-label">Scenario name</label>
                        <input id="input-scenario-name" class="input" type="text"
                               value="Baseline scale up">
                    </div>
                    <div class="field">
                        <label for="input-scenario-id" class="field-label">
                            Scenario id
                            <button class="icon-help tooltip-trigger"
                                    data-tooltip-title="Scenario id"
                                    data-tooltip-body="A technical identifier used to track the scenario in the library. Auto generated if left blank.">
                                i
                            </button>
                        </label>
                        <input id="input-scenario-id" class="input" type="text" placeholder="Auto">
                    </div>
                </div>

                <div class="field-row">
                    <div class="field">
                        <label for="input-assumption-set-id" class="field-label">
                            Assumption set
                        </label>
                        <select id="input-assumption-set-id" class="input">
                            <option value="mohfw-baseline">MoHFW baseline</option>
                            <option value="wb-downside">World Bank conservative</option>
                            <option value="wb-upside">World Bank optimistic</option>
                        </select>
                    </div>
                    <div class="field">
                        <label for="input-tier" class="field-label">
                            Programme tier
                            <button class="icon-help tooltip-trigger"
                                    data-tooltip-title="Programme tier"
                                    data-tooltip-body="Frontline, intermediate and advanced tiers differ in duration, mix of skills and implied outbreak response roles.">
                                i
                            </button>
                        </label>
                        <select id="input-tier" class="input">
                            <option value="frontline">Frontline</option>
                            <option value="intermediate">Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                    </div>
                </div>

                <div class="field-row">
                    <div class="field">
                        <label for="input-trainees-per-cohort" class="field-label">
                            Trainees per cohort
                        </label>
                        <input id="input-trainees-per-cohort" class="input" type="number"
                               min="1" max="500" step="1" value="25">
                    </div>
                    <div class="field">
                        <label for="input-number-of-cohorts" class="field-label">
                            Number of cohorts over horizon
                        </label>
                        <input id="input-number-of-cohorts" class="input" type="number"
                               min="1" max="200" step="1" value="4">
                    </div>
                </div>

                <div class="field-row">
                    <div class="field">
                        <label for="input-planning-horizon" class="field-label">
                            Planning horizon (years)
                        </label>
                        <input id="input-planning-horizon" class="input" type="number"
                               min="1" max="30" step="1" value="5">
                    </div>
                    <div class="field">
                        <label for="input-response-days" class="field-label">
                            Outbreak response time (days)
                            <button class="icon-help tooltip-trigger"
                                    data-tooltip-title="Response time"
                                    data-tooltip-body="Core configuration fixes outbreak response at 7 days. The 15 and 30 day options are retained for sensitivity analysis but are locked in the main view.">
                                i
                            </button>
                        </label>
                        <select id="input-response-days" class="input">
                            <option value="30" disabled>30 days (locked)</option>
                            <option value="15" disabled>15 days (locked)</option>
                            <option value="7" selected>7 days</option>
                        </select>
                    </div>
                </div>

                <div class="field-row">
                    <div class="field">
                        <label class="field-label">
                            Programme cost per trainee (INR)
                            <button class="icon-help tooltip-trigger"
                                    data-tooltip-title="Programme cost per trainee"
                                    data-tooltip-body="Average cost per trainee in INR including tuition, supervision and core delivery costs for the selected tier.">
                                i
                            </button>
                        </label>
                        <div class="slider-row">
                            <input id="input-cost-per-trainee" type="range"
                                   min="100000" max="800000" step="25000" value="400000">
                            <span id="cost-per-trainee-label" class="slider-value">400,000</span>
                        </div>
                    </div>
                    <div class="field">
                        <label for="input-endorsement-rate" class="field-label">
                            Endorsement rate (share)
                            <button class="icon-help tooltip-trigger"
                                    data-tooltip-title="Endorsement rate"
                                    data-tooltip-body="Predicted share of eligible epidemiologists who would endorse and choose the programme instead of the opt out option based on the preference model.">
                                i
                            </button>
                        </label>
                        <input id="input-endorsement-rate" class="input" type="number"
                               min="0" max="1" step="0.01" value="0.8">
                    </div>
                </div>

                <div class="field-row">
                    <div class="field">
                        <label for="input-completion-rate" class="field-label">
                            Completion rate (share)
                        </label>
                        <input id="input-completion-rate" class="input" type="number"
                               min="0" max="1" step="0.01" value="0.9">
                    </div>
                </div>

                <div class="button-row">
                    <button type="button" id="btn-apply-values" class="btn-primary">
                        Apply values
                    </button>
                    <button type="button" id="btn-reset-config" class="btn-ghost">
                        Reset to baseline
                    </button>
                </div>
            </div>

            <div class="config-summary">
                <h3>Configuration summary</h3>
                <dl class="summary-list">
                    <div>
                        <dt>Trainees per cohort</dt>
                        <dd id="summary-config-trainees-per-cohort">0</dd>
                    </div>
                    <div>
                        <dt>Number of cohorts</dt>
                        <dd id="summary-config-number-of-cohorts">0</dd>
                    </div>
                    <div>
                        <dt>Planning horizon (years)</dt>
                        <dd id="summary-config-horizon-years">0</dd>
                    </div>
                    <div>
                        <dt>Endorsement rate</dt>
                        <dd id="summary-config-endorsement">0 %</dd>
                    </div>
                    <div>
                        <dt>Completion rate</dt>
                        <dd id="summary-config-completion">0 %</dd>
                    </div>
                    <div>
                        <dt>Assumption set</dt>
                        <dd id="summary-assumption-label">MoHFW baseline</dd>
                    </div>
                </dl>
                <h3>Cost and benefit breakdown</h3>
                <dl class="summary-list">
                    <div>
                        <dt>Direct training costs (PV)</dt>
                        <dd id="summary-cost-direct">0</dd>
                    </div>
                    <div>
                        <dt>Opportunity cost (PV)</dt>
                        <dd id="summary-cost-opportunity">0</dd>
                    </div>
                    <div>
                        <dt>Total costs (PV)</dt>
                        <dd id="summary-cost-total">0</dd>
                    </div>
                    <div>
                        <dt>Total benefits (PV)</dt>
                        <dd id="summary-benefit-pv">0</dd>
                    </div>
                </dl>
            </div>
        </div>
    </section>

    <!-- Results and charts -->
    <section id="resultsTab" class="tabcontent card" hidden>
        <h2>Results and charts</h2>
        <div class="results-layout">
            <div class="results-block">
                <h3>National level summaries</h3>
                <p>
                    Over a planning horizon of
                    <span id="national-label-horizon">0</span> years the configured programme produces:
                </p>
                <ul class="plain-list">
                    <li><strong id="national-graduates">0</strong> graduates in total</li>
                    <li><strong id="national-outbreaks">0</strong> outbreak responses over the horizon</li>
                </ul>
            </div>
            <div class="results-block">
                <h3>Cost profile</h3>
                <canvas id="chart-costs" height="160"></canvas>
                <p id="chart-costs-summary" class="chart-summary"></p>
            </div>
            <div class="results-block">
                <h3>Benefits and costs</h3>
                <canvas id="chart-benefits" height="160"></canvas>
                <p id="chart-benefits-summary" class="chart-summary"></p>
            </div>
            <div class="results-block">
                <h3>Outbreak responses</h3>
                <canvas id="chart-outbreaks" height="160"></canvas>
                <p id="chart-outbreaks-summary" class="chart-summary"></p>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </section>

    <!-- Scenario library -->
    <section id="scenariosTab" class="tabcontent card" hidden>
        <h2>Scenario library</h2>
        <p>
            Save scenarios after configuring them so that you can reload and compare headline results later.
        </p>
        <div class="button-row">
            <button type="button" id="btn-save-scenario" class="btn-primary">
                Save or update scenario
            </button>
            <button type="button" id="btn-new-scenario" class="btn-ghost">
                Start new scenario
            </button>
        </div>
        <div class="table-wrapper">
            <table id="scenario-table" class="table">
                <thead>
                <tr>
                    <th>#</th>
                    <th>Name</th>
                    <th>Id</th>
                    <th>Assumptions</th>
                    <th>BCR</th>
                    <th>NPV (INR)</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                <!-- filled by script -->
                </tbody>
            </table>
        </div>
    </section>

    <!-- Assumptions -->
    <section id="settingsTab" class="tabcontent card" hidden>
        <h2>Assumption sets and discounting</h2>
        <div class="settings-layout">
            <div class="settings-form">
                <div class="field">
                    <label for="settings-assumption-preset" class="field-label">
                        Assumption preset
                    </label>
                    <select id="settings-assumption-preset" class="input">
                        <!-- filled by script -->
                    </select>
                </div>

                <div class="field-row">
                    <div class="field">
                        <label for="settings-discount-rate" class="field-label">
                            Discount rate (annual)
                        </label>
                        <input id="settings-discount-rate" class="input" type="number"
                               min="0" max="0.2" step="0.005">
                    </div>
                    <div class="field">
                        <label for="settings-outbreak-value" class="field-label">
                            Value per outbreak response (INR)
                        </label>
                        <input id="settings-outbreak-value" class="input" type="number"
                               min="0" max="5000000000" step="500000">
                    </div>
                </div>

                <div class="field-row">
                    <div class="field">
                        <label for="settings-opp-cost-share" class="field-label">
                            Opportunity cost share
                        </label>
                        <input id="settings-opp-cost-share" class="input" type="number"
                               min="0" max="1" step="0.05">
                    </div>
                </div>

                <div class="button-row">
                    <button type="button" id="btn-apply-settings" class="btn-primary">
                        Apply settings
                    </button>
                </div>
            </div>
            <div class="settings-log">
                <label for="settings-log" class="field-label">
                    Settings log
                </label>
                <textarea id="settings-log" rows="12" class="input monospace"></textarea>
            </div>
        </div>
    </section>

    <!-- Copilot tab -->
    <section id="copilotTab" class="tabcontent card" hidden>
        <h2>Microsoft Copilot briefing prompt</h2>
        <p>
            The Copilot tab prepares a complete text package that you can copy into Microsoft Copilot
            within the University of Newcastle environment. No data are sent automatically to external services.
        </p>
        <div class="button-row">
            <button type="button" id="btn-generate-copilot" class="btn-primary">
                Generate prompt
            </button>
            <button type="button" id="btn-copy-copilot" class="btn-ghost">
                Copy to clipboard
            </button>
        </div>
        <textarea id="copilot-prompt-output" class="input monospace" rows="20"></textarea>
    </section>

    <!-- Diagnostics -->
    <section id="diagnosticsTab" class="tabcontent card" hidden>
        <h2>Diagnostics</h2>
        <pre id="diagnosticsContent" class="diagnostics"></pre>
    </section>

    <!-- Help -->
    <section id="helpTab" class="tabcontent card" hidden>
        <h2>How to use the STEPS decision aid</h2>
        <p>
            1. Start on the Configuration tab and adjust trainee numbers, cohorts and cost assumptions.<br>
            2. Apply the configuration to update endorsement, costs, benefits and outbreak responses.<br>
            3. Save scenarios of interest into the Scenario library for comparison.<br>
            4. Use the Assumptions tab for structured sensitivity analysis on discount rates and outbreak values.<br>
            5. When ready, generate a Copilot prompt for a policy briefing.
        </p>
    </section>
</div>

<script src="script.js"></script>
</body>
</html>
